<div class="ui-g ui-fluid">
    <div>
        <p-card>
            <div class="ui-g-12">
                <div class="floatleft" style="width:20%">
                    <div>
                        <p-card header="Choose user:">
                            <div style="padding-top: 0.5em;">
                                <div class="floatleft">
                                    <span class="ui-float-label" style="padding-top: 0.2em">
                                        <input id="userHandle" type="text" size="20" [disabled]="processingAll || processingStats" [(ngModel)]="selectedUser" (input)="refreshAllWithTimeout()" pInputText autofocus> 
                                        <label for="userHandle">User handle</label>
                                    </span>
                                </div>
                                <div class="floatright">
                                    <p-progressSpinner *ngIf="processingAll || processingStats" [style]="{width: '30px', height: '30px'}"></p-progressSpinner>
                                </div>
                            </div>
                            <div style="padding-top: 2em;">
                                <div class="floatleft">
                                    <p-checkbox binary="true" label="Choose specific Time" [(ngModel)]="useDateRange" [disabled]="processingAll || processingStats" (onChange)="refreshStatsWithTimeout()"></p-checkbox>
                                </div>
                                <div class="floatleft" style="width: 80%">
                                    <label disabled="!useDateRange"><b>From</b></label>
                                    <p-calendar [disabled]="!useDateRange" [(ngModel)]="fromDate" [monthNavigator]="true" [yearNavigator]="true" yearRange="2017:2030" [showTime]="true" showSeconds="true" dateFormat="dd.mm.yy" (onSelect)="refreshStatsWithTimeout()"></p-calendar>
                                </div>
                                <div class="floatleft" style="width: 80%">
                                    <label><b>To</b></label>
                                    <p-calendar [disabled]="!useDateRange" [(ngModel)]="toDate" [monthNavigator]="true" [yearNavigator]="true" yearRange="2017:2030" [showTime]="true" showSeconds="true" dateFormat="dd.mm.yy" (onSelect)="refreshStatsWithTimeout()"></p-calendar>
                                </div>
                                <div class="floatleft" style="width: 80%">
                                    <label style="font-size: 9px;"><b>DB timestamps are in UTC, so your selected time will be converted into UTC as well!</b></label>
                                </div>
                            </div>
                        </p-card>
                    </div>
                    <div style="padding-top: 1.5em;">
                        <p-card header="User Stats">
                            <p-table [value]="userStats" [style]="{'width':'100%'}">
                                <ng-template pTemplate="header">
                                    <tr>
                                        <th style="width: 38%"></th>
                                        <th style="width: 22%">Count</th>
                                        <th style="width: 40%">XRP</th>
                                    </tr>
                                </ng-template>
                                <ng-template pTemplate="body" let-userStats>
                                    <tr>
                                        <td><b>{{userStats['label']}}</b></td>
                                        <td style="text-align: center">{{userStats['count']}}</td>
                                        <td style="text-align: center">{{userStats['xrp']}}</td>
                                    </tr>
                                </ng-template>
                            </p-table>
                        </p-card>
                    </div>
                </div>
                <div class="floatright" style="width: 80%;padding-left: 1em;">
                    <p-card header="Top Activities">
                        <div *ngIf="useDateRange" class="ui-g-12">
                            <label>From: {{fromDate ? fromDate.toUTCString():''}}</label><br>
                            <label>To: {{toDate ? toDate.toUTCString():''}}</label>
                        </div>
                        <div class="ui-g-12">
                            <div class="floatleft" style="width: 25%">
                                <h3>Most tips received from</h3>
                                <div class="center">
                                    <p-table [value]="topReceivedTips" [style]="{'width':'95%'}">
                                        <ng-template pTemplate="header">
                                            <tr>
                                                <th style="width: 65%">User</th>
                                                <th style="width: 35%">Tips</th>
                                            </tr>
                                        </ng-template>
                                        <ng-template pTemplate="body" let-topReceivedTips>
                                            <tr>
                                                <td><a style="color:blue; text-align: center" href="https://twitter.com/{{topReceivedTips['_id']}}">{{topReceivedTips['_id']}}</a></td>
                                                <td style="text-align: center">{{topReceivedTips['count']}}</td>
                                            </tr>
                                        </ng-template>
                                    </p-table>
                                </div>
                            </div>
                            <div class="floatleft" style="width: 25%">
                                <h3>Most XRP received from</h3>
                                <div class="center">
                                    <p-table [value]="topReceivedXRP" [style]="{'width':'95%'}">
                                        <ng-template pTemplate="header">
                                            <tr>
                                                <th style="width: 65%">User</th>
                                                <th style="width: 35%">XRP</th>
                                            </tr>
                                        </ng-template>
                                        <ng-template pTemplate="body" let-topReceivedXRP>
                                            <tr>
                                                <td><a style="color:blue; text-align: center" href="https://twitter.com/{{topReceivedXRP['_id']}}">{{topReceivedXRP['_id']}}</a></td>
                                                <td style="text-align: center">{{topReceivedXRP['xrp']}}</td>
                                            </tr>
                                        </ng-template>
                                    </p-table>
                                </div>
                            </div>
                            <div class="floatleft" style="width: 25%">
                                <h3>Most tips sent to</h3>
                                <div class="center">
                                    <p-table [value]="topSentTips" [style]="{'width':'95%'}">
                                        <ng-template pTemplate="header">
                                            <tr>
                                                <th style="width: 65%">User</th>
                                                <th style="width: 35%">Tips</th>
                                            </tr>
                                        </ng-template>
                                        <ng-template pTemplate="body" let-topSentTips>
                                            <tr>
                                                <td><a style="color:blue; text-align: center" href="https://twitter.com/{{topSentTips['_id']}}">{{topSentTips['_id']}}</a></td>
                                                <td style="text-align: center">{{topSentTips['count']}}</td>
                                            </tr>
                                        </ng-template>
                                    </p-table>
                                </div>
                            </div>
                            <div class="floatleft" style="width: 25%">
                                <h3>Most XRP sent to (via tip)</h3>
                                <div class="center">
                                    <p-table [value]="topSentXRP" [style]="{'width':'95%'}">
                                        <ng-template pTemplate="header">
                                            <tr>
                                                <th style="width: 65%">User</th>
                                                <th style="width: 35%">XRP</th>
                                            </tr>
                                        </ng-template>
                                        <ng-template pTemplate="body" let-topSentXRP>
                                            <tr>
                                                <td><a style="color:blue; text-align: center" href="https://twitter.com/{{topSentXRP['_id']}}">{{topSentXRP['_id']}}</a></td>
                                                <td style="text-align: center">{{topSentXRP['xrp']}}</td>
                                            </tr>
                                        </ng-template>
                                    </p-table>
                                </div>
                            </div>
                        </div>
                    </p-card>
                </div>
            </div>
        </p-card>
    </div>
    <div style="padding-top: 2em;">
        <div class="ui-g-12 floatleft" style="width: 20%;">
            <p-card header="User Chart">
                <div class="ui-g-12">
                    <div class="floatleft">
                        <p-dropdown [options]="daysOrWeeksDropDown" [(ngModel)]="selectedDayOrWeek" (onChange)="refreshChartWithTimeout()"></p-dropdown>
                    </div>
                    <div class="floatcenter" style="padding-left: 1em;">
                        <p-spinner size="3" [(ngModel)]="daysToReceive" [min]="1" [max]="20" [maxlength]="2" (input)="refreshChartWithTimeout()" (onChange)="refreshChartWithTimeout()"></p-spinner>
                    </div>
                    <div class="floatright">
                        <p-progressSpinner *ngIf="!processingAll && processingChart" [style]="{width: '30px', height: '30px'}"></p-progressSpinner>
                    </div>
                </div>
                <div class="ui-g-12">
                    <div class="floatleft">
                        <p-checkbox binary="true" label="Include direct Deposits" [(ngModel)]="includeDeposits" (onChange)="refreshChartWithTimeout()"></p-checkbox>
                    </div>
                </div>
            </p-card>
        </div>
        <div class="ui-g-12 center-screen" style="margin: 0 auto">
            <p-chart type="bar" [data]="chartData" [options]="options" width="95vw" height="50vh"></p-chart>
        </div>
    </div>
</div>
